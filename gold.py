# -*- coding: utf-8 -*-

import smtplib
from email.mime.text import MIMEText
from email.header import Header
import requests
import re
import datetime
import ssl
import json
import datetime
#import excel
from HandleCsv import HandleCsv
from Send_Wechart import Send_Wechart
from Send_Email import Send_Email
import csv
import time
import datetime

#from datetime import datetime
# dict_test={"times":["20:00","20:01","20:02","20:03","20:04","20:05","20:06","20:07","20:08","20:09","20:10","20:11","20:12","20:13","20:14","20:15","20:16","20:17","20:18","20:19","20:20","20:21","20:22","20:23","20:24","20:25","20:26","20:27","20:28","20:29","20:30","20:31","20:32","20:33","20:34","20:35","20:36","20:37","20:38","20:39","20:40","20:41","20:42","20:43","20:44","20:45","20:46","20:47","20:48","20:49","20:50","20:51","20:52","20:53","20:54","20:55","20:56","20:57","20:58","20:59","21:00","21:01","21:02","21:03","21:04","21:05","21:06","21:07","21:08","21:09","21:10","21:11","21:12","21:13","21:14","21:15","21:16","21:17","21:18","21:19","21:20","21:21","21:22","21:23","21:24","21:25","21:26","21:27","21:28","21:29","21:30","21:31","21:32","21:33","21:34","21:35","21:36","21:37","21:38","21:39","21:40","21:41","21:42","21:43","21:44","21:45","21:46","21:47","21:48","21:49","21:50","21:51","21:52","21:53","21:54","21:55","21:56","21:57","21:58","21:59","22:00","22:01","22:02","22:03","22:04","22:05","22:06","22:07","22:08","22:09","22:10","22:11","22:12","22:13","22:14","22:15","22:16","22:17","22:18","22:19","22:20","22:21","22:22","22:23","22:24","22:25","22:26","22:27","22:28","22:29","22:30","22:31","22:32","22:33","22:34","22:35","22:36","22:37","22:38","22:39","22:40","22:41","22:42","22:43","22:44","22:45","22:46","22:47","22:48","22:49","22:50","22:51","22:52","22:53","22:54","22:55","22:56","22:57","22:58","22:59","23:00","23:01","23:02","23:03","23:04","23:05","23:06","23:07","23:08","23:09","23:10","23:11","23:12","23:13","23:14","23:15","23:16","23:17","23:18","23:19","23:20","23:21","23:22","23:23","23:24","23:25","23:26","23:27","23:28","23:29","23:30","23:31","23:32","23:33","23:34","23:35","23:36","23:37","23:38","23:39","23:40","23:41","23:42","23:43","23:44","23:45","23:46","23:47","23:48","23:49","23:50","23:51","23:52","23:53","23:54","23:55","23:56","23:57","23:58","23:59","00:00","00:01","00:02","00:03","00:04","00:05","00:06","00:07","00:08","00:09","00:10","00:11","00:12","00:13","00:14","00:15","00:16","00:17","00:18","00:19","00:20","00:21","00:22","00:23","00:24","00:25","00:26","00:27","00:28","00:29","00:30","00:31","00:32","00:33","00:34","00:35","00:36","00:37","00:38","00:39","00:40","00:41","00:42","00:43","00:44","00:45","00:46","00:47","00:48","00:49","00:50","00:51","00:52","00:53","00:54","00:55","00:56","00:57","00:58","00:59","01:00","01:01","01:02","01:03","01:04","01:05","01:06","01:07","01:08","01:09","01:10","01:11","01:12","01:13","01:14","01:15","01:16","01:17","01:18","01:19","01:20","01:21","01:22","01:23","01:24","01:25","01:26","01:27","01:28","01:29","01:30","01:31","01:32","01:33","01:34","01:35","01:36","01:37","01:38","01:39","01:40","01:41","01:42","01:43","01:44","01:45","01:46","01:47","01:48","01:49","01:50","01:51","01:52","01:53","01:54","01:55","01:56","01:57","01:58","01:59","02:00","02:01","02:02","02:03","02:04","02:05","02:06","02:07","02:08","02:09","02:10","02:11","02:12","02:13","02:14","02:15","02:16","02:17","02:18","02:19","02:20","02:21","02:22","02:23","02:24","02:25","02:26","02:27","02:28","02:29","02:30","09:00","09:01","09:02","09:03","09:04","09:05","09:06","09:07","09:08","09:09","09:10","09:11","09:12","09:13","09:14","09:15","09:16","09:17","09:18","09:19","09:20","09:21","09:22","09:23","09:24","09:25","09:26","09:27","09:28","09:29","09:30","09:31","09:32","09:33","09:34","09:35","09:36","09:37","09:38","09:39","09:40","09:41","09:42","09:43","09:44","09:45","09:46","09:47","09:48","09:49","09:50","09:51","09:52","09:53","09:54","09:55","09:56","09:57","09:58","09:59","10:00","10:01","10:02","10:03","10:04","10:05","10:06","10:07","10:08","10:09","10:10","10:11","10:12","10:13","10:14","10:15","10:16","10:17","10:18","10:19","10:20","10:21","10:22","10:23","10:24","10:25","10:26","10:27","10:28","10:29","10:30","10:31","10:32","10:33","10:34","10:35","10:36","10:37","10:38","10:39","10:40","10:41","10:42","10:43","10:44","10:45","10:46","10:47","10:48","10:49","10:50","10:51","10:52","10:53","10:54","10:55","10:56","10:57","10:58","10:59","11:00","11:01","11:02","11:03","11:04","11:05","11:06","11:07","11:08","11:09","11:10","11:11","11:12","11:13","11:14","11:15","11:16","11:17","11:18","11:19","11:20","11:21","11:22","11:23","11:24","11:25","11:26","11:27","11:28","11:29","11:30","11:30","11:31","11:32","11:33","11:34","11:35","11:36","11:37","11:38","11:39","11:40","11:41","11:42","11:43","11:44","11:45","11:46","11:47","11:48","11:49","11:50","11:51","11:52","11:53","11:54","11:55","11:56","11:57","11:58","11:59","12:00","12:01","12:02","12:03","12:04","12:05","12:06","12:07","12:08","12:09","12:10","12:11","12:12","12:13","12:14","12:15","12:16","12:17","12:18","12:19","12:20","12:21","12:22","12:23","12:24","12:25","12:26","12:27","12:28","12:29","12:30","12:31","12:32","12:33","12:34","12:35","12:36","12:37","12:38","12:39","12:40","12:41","12:42","12:43","12:44","12:45","12:46","12:47","12:48","12:49","12:50","12:51","12:52","12:53","12:54","12:55","12:56","12:57","12:58","12:59","13:00","13:01","13:02","13:03","13:04","13:05","13:06","13:07","13:08","13:09","13:10","13:11","13:12","13:13","13:14","13:15","13:16","13:17","13:18","13:19","13:20","13:21","13:22","13:23","13:24","13:25","13:26","13:27","13:28","13:29","13:30","13:31","13:32","13:33","13:34","13:35","13:36","13:37","13:38","13:39","13:40","13:41","13:42","13:43","13:44","13:45","13:46","13:47","13:48","13:49","13:50","13:51","13:52","13:53","13:54","13:55","13:56","13:57","13:58","13:59","14:00","14:01","14:02","14:03","14:04","14:05","14:06","14:07","14:08","14:09","14:10","14:11","14:12","14:13","14:14","14:15","14:16","14:17","14:18","14:19","14:20","14:21","14:22","14:23","14:24","14:25","14:26","14:27","14:28","14:29","14:30","14:31","14:32","14:33","14:34","14:35","14:36","14:37","14:38","14:39","14:40","14:41","14:42","14:43","14:44","14:45","14:46","14:47","14:48","14:49","14:50","14:51","14:52","14:53","14:54","14:55","14:56","14:57","14:58","14:59","15:00","15:01","15:02","15:03","15:04","15:05","15:06","15:07","15:08","15:09","15:10","15:11","15:12","15:13","15:14","15:15","15:16","15:17","15:18","15:19","15:20","15:21","15:22","15:23","15:24","15:25","15:26","15:27","15:28","15:29","15:30"],"min":380,"data":["381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97"],"max":381,"heyue":"Au99.95","delaystr":"2021年02月10日 09:34:55"} 

dict_test={"times":["20:00","20:01","20:02","20:03","20:04","20:05","20:06","20:07","20:08","20:09","20:10","20:11","20:12","20:13","20:14","20:15","20:16","20:17","20:18","20:19","20:20","20:21","20:22","20:23","20:24","20:25","20:26","20:27","20:28","20:29","20:30","20:31","20:32","20:33","20:34","20:35","20:36","20:37","20:38","20:39","20:40","20:41","20:42","20:43","20:44","20:45","20:46","20:47","20:48","20:49","20:50","20:51","20:52","20:53","20:54","20:55","20:56","20:57","20:58","20:59","21:00","21:01","21:02","21:03","21:04","21:05","21:06","21:07","21:08","21:09","21:10","21:11","21:12","21:13","21:14","21:15","21:16","21:17","21:18","21:19","21:20","21:21","21:22","21:23","21:24","21:25","21:26","21:27","21:28","21:29","21:30","21:31","21:32","21:33","21:34","21:35","21:36","21:37","21:38","21:39","21:40","21:41","21:42","21:43","21:44","21:45","21:46","21:47","21:48","21:49","21:50","21:51","21:52","21:53","21:54","21:55","21:56","21:57","21:58","21:59","22:00","22:01","22:02","22:03","22:04","22:05","22:06","22:07","22:08","22:09","22:10","22:11","22:12","22:13","22:14","22:15","22:16","22:17","22:18","22:19","22:20","22:21","22:22","22:23","22:24","22:25","22:26","22:27","22:28","22:29","22:30","22:31","22:32","22:33","22:34","22:35","22:36","22:37","22:38","22:39","22:40","22:41","22:42","22:43","22:44","22:45","22:46","22:47","22:48","22:49","22:50","22:51","22:52","22:53","22:54","22:55","22:56","22:57","22:58","22:59","23:00","23:01","23:02","23:03","23:04","23:05","23:06","23:07","23:08","23:09","23:10","23:11","23:12","23:13","23:14","23:15","23:16","23:17","23:18","23:19","23:20","23:21","23:22","23:23","23:24","23:25","23:26","23:27","23:28","23:29","23:30","23:31","23:32","23:33","23:34","23:35","23:36","23:37","23:38","23:39","23:40","23:41","23:42","23:43","23:44","23:45","23:46","23:47","23:48","23:49","23:50","23:51","23:52","23:53","23:54","23:55","23:56","23:57","23:58","23:59","00:00","00:01","00:02","00:03","00:04","00:05","00:06","00:07","00:08","00:09","00:10","00:11","00:12","00:13","00:14","00:15","00:16","00:17","00:18","00:19","00:20","00:21","00:22","00:23","00:24","00:25","00:26","00:27","00:28","00:29","00:30","00:31","00:32","00:33","00:34","00:35","00:36","00:37","00:38","00:39","00:40","00:41","00:42","00:43","00:44","00:45","00:46","00:47","00:48","00:49","00:50","00:51","00:52","00:53","00:54","00:55","00:56","00:57","00:58","00:59","01:00","01:01","01:02","01:03","01:04","01:05","01:06","01:07","01:08","01:09","01:10","01:11","01:12","01:13","01:14","01:15","01:16","01:17","01:18","01:19","01:20","01:21","01:22","01:23","01:24","01:25","01:26","01:27","01:28","01:29","01:30","01:31","01:32","01:33","01:34","01:35","01:36","01:37","01:38","01:39","01:40","01:41","01:42","01:43","01:44","01:45","01:46","01:47","01:48","01:49","01:50","01:51","01:52","01:53","01:54","01:55","01:56","01:57","01:58","01:59","02:00","02:01","02:02","02:03","02:04","02:05","02:06","02:07","02:08","02:09","02:10","02:11","02:12","02:13","02:14","02:15","02:16","02:17","02:18","02:19","02:20","02:21","02:22","02:23","02:24","02:25","02:26","02:27","02:28","02:29","02:30","09:00","09:01","09:02","09:03","09:04","09:05","09:06","09:07","09:08","09:09","09:10","09:11","09:12","09:13","09:14","09:15","09:16","09:17","09:18","09:19","09:20","09:21","09:22","09:23","09:24","09:25","09:26","09:27","09:28","09:29","09:30","09:31","09:32","09:33","09:34","09:35","09:36","09:37","09:38","09:39","09:40","09:41","09:42","09:43","09:44","09:45","09:46","09:47","09:48","09:49","09:50","09:51","09:52","09:53","09:54","09:55","09:56","09:57","09:58","09:59","10:00","10:01","10:02","10:03","10:04","10:05","10:06","10:07","10:08","10:09","10:10","10:11","10:12","10:13","10:14","10:15","10:16","10:17","10:18","10:19","10:20","10:21","10:22","10:23","10:24","10:25","10:26","10:27","10:28","10:29","10:30","10:31","10:32","10:33","10:34","10:35","10:36","10:37","10:38","10:39","10:40","10:41","10:42","10:43","10:44","10:45","10:46","10:47","10:48","10:49","10:50","10:51","10:52","10:53","10:54","10:55","10:56","10:57","10:58","10:59","11:00","11:01","11:02","11:03","11:04","11:05","11:06","11:07","11:08","11:09","11:10","11:11","11:12","11:13","11:14","11:15","11:16","11:17","11:18","11:19","11:20","11:21","11:22","11:23","11:24","11:25","11:26","11:27","11:28","11:29","11:30","11:30","11:31","11:32","11:33","11:34","11:35","11:36","11:37","11:38","11:39","11:40","11:41","11:42","11:43","11:44","11:45","11:46","11:47","11:48","11:49","11:50","11:51","11:52","11:53","11:54","11:55","11:56","11:57","11:58","11:59","12:00","12:01","12:02","12:03","12:04","12:05","12:06","12:07","12:08","12:09","12:10","12:11","12:12","12:13","12:14","12:15","12:16","12:17","12:18","12:19","12:20","12:21","12:22","12:23","12:24","12:25","12:26","12:27","12:28","12:29","12:30","12:31","12:32","12:33","12:34","12:35","12:36","12:37","12:38","12:39","12:40","12:41","12:42","12:43","12:44","12:45","12:46","12:47","12:48","12:49","12:50","12:51","12:52","12:53","12:54","12:55","12:56","12:57","12:58","12:59","13:00","13:01","13:02","13:03","13:04","13:05","13:06","13:07","13:08","13:09","13:10","13:11","13:12","13:13","13:14","13:15","13:16","13:17","13:18","13:19","13:20","13:21","13:22","13:23","13:24","13:25","13:26","13:27","13:28","13:29","13:30","13:31","13:32","13:33","13:34","13:35","13:36","13:37","13:38","13:39","13:40","13:41","13:42","13:43","13:44","13:45","13:46","13:47","13:48","13:49","13:50","13:51","13:52","13:53","13:54","13:55","13:56","13:57","13:58","13:59","14:00","14:01","14:02","14:03","14:04","14:05","14:06","14:07","14:08","14:09","14:10","14:11","14:12","14:13","14:14","14:15","14:16","14:17","14:18","14:19","14:20","14:21","14:22","14:23","14:24","14:25","14:26","14:27","14:28","14:29","14:30","14:31","14:32","14:33","14:34","14:35","14:36","14:37","14:38","14:39","14:40","14:41","14:42","14:43","14:44","14:45","14:46","14:47","14:48","14:49","14:50","14:51","14:52","14:53","14:54","14:55","14:56","14:57","14:58","14:59","15:00","15:01","15:02","15:03","15:04","15:05","15:06","15:07","15:08","15:09","15:10","15:11","15:12","15:13","15:14","15:15","15:16","15:17","15:18","15:19","15:20","15:21","15:22","15:23","15:24","15:25","15:26","15:27","15:28","15:29","15:30"],"min":380,"data":["381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","381.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97","379.97"],"max":381,"heyue":"Au99.95","delaystr":"2021年02月14日 12:54:55"} 


requests.packages.urllib3.disable_warnings()
context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)
context.verify_mode = ssl.CERT_NONE

# #黄金网站
# url = "https://www.sge.com.cn/graph/quotations"#"https://www.sge.com.cn/graph/quotations"#http://www.sge.com.cn/hqsj#https://www.sge.com.cn/graph/quotations#"https://mybank.icbc.com.cn/icbc/newperbank/perbank3/realGold/realgold_query_pic_big_nologin.jsp?mode=2&preprodcode=080020000219&prechartType=realtime&Area_code=0200"#https://mybank.icbc.com.cn/icbc/newperbank/perbank3/frame/frame_index.jsp?serviceId=PBL201311#"#http://www.sge.com.cn/

# def url_open(url):
#     try:
#         #page_headers={
#         ##  'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.221 Safari/537.36 SE 2.X MetaSr 1.0',
#         # 'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.104 Safari/537.36',
#         # }
#         page_headers={
#              'Accept': 'application/json, text/javascript, */*; q=0.01',
#              'Host': 'www.sge.com.cn',
#              'Referer': 'https://www.sge.com.cn/',
#              'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'
#         }
#         #res=requests.get(url,headers=page_headers,verify=False)
#         data = {'instid':'Au99.95'}
#         print("数据如下11")
#         ss = requests.session()
#         res=ss.post(url,headers=page_headers,verify=False,data=data)
#         #res = requests.post(url, data=data,verify=False,headers=page_headers)
#         print("数据如下")
#         print(res)
#         print("数据如下1")
#         print(res.text)   
#         #with open('1.txt','w+') as fh:
#         # fh.write(res.text)
#         file_handle=open('0207.txt',mode='w')    
#         file_handle.write(res.text)
#         status=res.status_code
#         data=res.text
#         return data
#     except:
#         pass
    
# def get_today():
#     h=datetime.datetime.now()
#     today=h.strftime("%Y-%m-%d")  
#     print("数据如下2")
#     print(today)  
#     return today

# def get_gold():
#     try:
#         fileName='gold_price.txt'
#         message=''
#         data=url_open(url)
#         today_date=get_today()
#         print("数据如下3")
#         print(today_date)  
#         #today_date = "2021-01-29"
#         # pat1='<span class="fl color999">（(.*?)）'
#         # pat2='<span class="colorRed fs24">(.+?)<'
#         pat1='行情日期：(.+?)<'
#         print("数据如下4.1")
#         statis_time=re.compile(pat1).findall(data)[0]
#         pat2='<li><p>上海银早盘价（元/千克）</p><span class="colorRed fs20">(.+?)<'
#         today_price=re.compile(pat2).findall(data)[0]
#         print("数据如下4")
#         print(statis_time)  
#         print("数据如下5")
#         print(today_price)                  
#         # with open(fileName,'a+') as fh:
#         #     fh.write("日期："+today_date+"\t"+statis_time+"\t"+"早盘价："+today_price+"\n")
        	
#         message=statis_time+"的黄金价格为:"+str(today_price)
#         return message
#     except:
#         return "无法获取到黄金价格信息"



# def mail_qq(subject,content):
#     mail_host="smtp.qq.com"#设置服务器
#     mail_user="1xxxx@qq.com"#用户名
#     mail_pass="fobbaybdiubfgjhd"#密码
#     sender="1xx@qq.com"
#     receivers=['1xxxxxxx@qq.com']#接收邮件
#     try:
#         message=MIMEText(content,'plain','utf-8')
#         message['From']=Header("小平",'utf-8')#发件人昵称
#         message['To']=Header("小平",'utf-8')#收件人昵称
        
#         message['Subject']=Header(subject,'utf-8')
        
#         server=smtplib.SMTP_SSL(mail_host,465)
#         server.login(mail_user,mail_pass)
#         server.sendmail(sender,receivers,message.as_string())
        
#         server.quit()#关闭链接
#         print("邮件发送成功")
#     except Exception as e:
#         print(e)
#         print("邮件发送失败")


#黄金网站
#url = "https://www.sge.com.cn/graph/quotations"#"https://www.sge.com.cn/graph/quotations"#http://www.sge.com.cn/hqsj#https://www.sge.com.cn/graph/quotations#"https://mybank.icbc.com.cn/icbc/newperbank/perbank3/realGold/realgold_query_pic_big_nologin.jsp?mode=2&preprodcode=080020000219&prechartType=realtime&Area_code=0200"#https://mybank.icbc.com.cn/icbc/newperbank/perbank3/frame/frame_index.jsp?serviceId=PBL201311#"#http://www.sge.com.cn/
#url_price = "https://www.sge.com.cn/graph/quotations"
url = "https://www.microsoftstore.com.cn/certified-refurbished-surface-go-configurate"
def getYesterday(): 
    today=datetime.date.today() 
    print("今天的时间:",today)
    #str = '2012-11-01'
    #today = datetime.datetime.strptime(str,'%Y-%m-%d')
    oneday=datetime.timedelta(days=1) 
    yesterday=today-oneday  
    yesterday = yesterday.strftime("%Y-%m-%d")
    yesterday = yesterday.replace('-','年',1)
    yesterday = yesterday.replace('-','月',1)
    yesterday += '日'
    yesterday.replace(' ','')
    print("昨天时间为1：",yesterday) 
    
    return yesterday

def replace_char(string,char,index):
     string = list(string)
     string[index] = char
     return ''.join(string)

def url_open(url):
    try:
        # page_headers={
        #      'Accept': 'application/json, text/javascript, */*; q=0.01',
        #      'Host': 'www.sge.com.cn',
        #      'Referer': 'https://www.sge.com.cn/',
        #      'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'
        # }
        page_headers={
             'Accept': 'application/json, text/javascript, */*; q=0.01',
             'Host': 'www.microsoftstore.com.cn',
             'Referer': 'https://www.microsoftstore.com.cn/certified-refurbished-surface-go-configurate',
             'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36'
        }

        
        data = {'instid':'Ag(T+D)'}
        #print("数据如下11")
        ss = requests.session()
        res=ss.post(url,headers=page_headers,verify=False,data=data)
        #print("数据如下")
        #print(res)
        print("数据如下1")
        print(res.text)   
        file_handle=open('0306.txt',mode='w')    
        #file_handle.write('hello,world!\n')
        html = res.text

        with open('title.txt','w',encoding='utf-8') as file_handle:
            file_handle.write(html)
            file_handle.close()

        status=res.status_code
        if status!= 200:
            print("访问异常")
            return '-1'
        else:
            #print("status:",status)
            data=res.text
            return data
    except:
        pass
    
def get_today():
    h=datetime.datetime.now()
    today=h.strftime("%Y-%m-%d")  
    #print("数据如下2")
    #print(today)  
    return today

# def get_gold():
#     try:
#         fileName='gold_price.txt'
#         message=''
#         data = url_open(url)
#         today_date=get_today()
#         print("数据如下3")
#         print(today_date)  
#         print("数据如下3.31")
#         #print(data) 
#         dict1 = json.loads(data)
#         list1 = dict1['times']
#         list2 = dict1['data']
#         #today_date = "2021-01-29"
#         # pat1='<span class="fl color999">（(.*?)）'
#         # pat2='<span class="colorRed fs24">(.+?)<'
#         pat1='行情日期：(.+?)<'
#         print("数据如下4.1")
#         # statis_time=re.compile(pat1).findall(data)[0]
#         # pat2='<li><p>上海银早盘价（元/千克）</p><span class="colorRed fs20">(.+?)<'
#         # today_price=re.compile(pat2).findall(data)[0]
#         # print("数据如下4")
#         # print(statis_time)  
#         # print("数据如下5")
#         # print(today_price)                  
#         # with open(fileName,'a+') as fh:
#         #     fh.write("日期："+today_date+"\t"+statis_time+"\t"+"早盘价："+today_price+"\n")
        	
#         #message=statis_time+"的黄金价格为:"+str(today_price)
#         message = "测试数据"
#         list1 = [message,data]
#         return list1
#     except:
#         return "无法获取到黄金价格信息"

def get_data():
    try:
        fileName='gold_price.txt'
        message=''
        data = url_open(url)
        today_date=get_today()
        #print("数据如下3")
        print(today_date)  
        #print(data) 
        dict1 = json.loads(data)
        #dict1 = dict_test
        # print("测试数据为：",data) 
        list1 = dict1['times']
        list2 = dict1['data']
        print("data1:",list1,"data2:",list2) 
        # for i in range(0,len(list1)):
        #     print(list1[i] + "--" + list2[i])

        now_time = dict1['delaystr']
        print("数据刷新时间"+now_time[12:17]) #取当前时间
        
        try:
            position = list1.index(now_time[12:17]) #取当前时间的前一个点数据
            print("偏移量",position)
            #早上8点前和次日下午3点半后，都不取，包括上面这两个点
            if position == 0:
                return "不在时间范围内"
            elif position == 782:
                return "不在时间范围内"
        except:
            print("不在时间范围内")
            #return "不在时间范围内"
            position = 1 #调试用
        
        data_momey = list2[position-1]
        #print("当前时间"+list1[position-1] + "当前数值："+list2[position-1]) #取当前时间
        message = "当前时间默认为"+list1[position-1] + "  当前数值为："+list2[position-1]
        print(message)
        list_dict = [list1,list2,position,now_time[0:17]]#整个时间拿过去
        return list_dict
    except:
        return "取数失败"

def get_string(data):
    c = "["
    try:
        res = None
        for i in range(0, len(data)): 
            if ini_string[i] == c: 
                res = i + 1
                break
            
        if res == None: 
            print ("No such charater available in string") 
        else: 
            print ("Character {} is present at {}".format(c, str(res))) 

    except:
        return "找不到数据"

def porcess_wechart():
    wechart_send = Send_Wechart(u'jamly_liu')
    wechart_send.send_move(u'jamly_liu','jamly_liu')

def porcess_csv(dict_txt,time,list_dic):
    #list_date = list_dic[0]
    list_data = list_dic[1]

    dict_txt[time] = list_data[int(list_dic[2])-1]#list_dic[2]为list的漂移量，dict_txt为字典数据
    h_csv = HandleCsv(u'C:/Users/liuzj/Desktop/gold/data_test.csv')
    csv_line = h_csv.get_list_len(0)#拿到行数
    print("csv行数为:",csv_line)
    #print("day_date[11:16]:",day_date[11:16])
    #print("day_tmp数据为：",day_tmp)
    h_csv.insert_row(csv_line+1)
    h_csv.insert_col(csv_line+1, 1, time[0:10])#日期
    h_csv.insert_col(csv_line+1, 2, time[11:16])#时间
    h_csv.insert_col(csv_line+1, 3, dict_txt[time])#数值
    h_csv.list2csv(u'C:/Users/liuzj/Desktop/gold/data_test.csv')
    return dict_txt


def change_csv(list_dic):
    #list_date = list_dic[0]
    #list_data = list_dic[1]
    len1 = len(list_dic[0])
    print("len长度:",len1)
    h_csv = HandleCsv(u'C:/Users/liuzj/Desktop/gold/data_get1.csv')
    #for i in list_dic[0] :
    for i in range(0,782):
        csv_line = h_csv.get_list_len(0)#拿到行数
        print("csv行数为:",csv_line)
        h_csv.insert_row(csv_line+1)
        h_csv.insert_col(csv_line+1, 1, list_dic[0][i])#时间
        h_csv.insert_col(csv_line+1, 2, list_dic[1][i])#数值
        #h_csv.insert_col(csv_line+1, 2, i)
        #print("list_date:",list_date,"list_data:",list_data)
        h_csv.list2csv(u'C:/Users/liuzj/Desktop/gold/data_get1.csv')




def porcess_dict(list_dic):
    list_date = list_dic[0]
    #list_data = list_dic[1]

    file = open('C:\\Users\\liuzj\\Desktop\\gold\\dict.txt','r') 
    f1 = file.read()
    file.close()  
    print("dict.txt数据为：",f1) 
    dict_txt = eval(f1)
    print("dict.txt为：",dict_txt) 
    if list_date[0] in f1:
        print("存在")
        return '1'
    else:
        #如果当前时间为00:00，那取-1的时间就是跨天了，要对记录的时间做处理
        list_tmp = list_dic[3]
        list_tmp = list_tmp[12:17]
        if list_tmp == '00:00':
            print("数据跨天了：",list_tmp) 
            day_date = getYesterday()
        else:
            list_tmp = list_dic[3]
            day_date = list_tmp[0:11]    
        
        day_date += list_date[int(list_dic[2])-1]#加上时间

    str_txt = str(porcess_csv(dict_txt,day_date,list_dic))
    change_csv(list_dic)
    #print("最后数据：",str_txt)
    file = open('dict.txt', 'w') 
    file.write(str_txt)
    file.close()  
    return '0'

#def process_monitor(subject,now_price): #判断当前价格与24小时前差值，通过position比较

#与昨天的第239个数据比较(59分)
def check_price(list_dic):
    return 1

def check_time():#检测当前时间是否可比较    
    #str = '2021-02-28'
    #today1 = datetime.datetime.strptime(str,'%Y-%m-%d')
    week = datetime.date.today().strftime('%w')#星期天:0,0-6
    print("今天星期几：",week)
    h=datetime.datetime.now()
    time_now=h.strftime("%H:%M:%S")  
    print("今天时间：",time_now)
    #time_now = datetime.datetime.now().strftime("%H:%M:%S")
    #week = today.strftime('%w')
    if week == 5 or week == 0:  #周六和周日不检测
        return -1
    else:
        return 0
        
if __name__ == '__main__':
    data = url_open(url)
    #subject = get_data()
    #porcess_dict(subject)
    #today_data=get_today()
    #get_time()
    #check_time()
    #email_send = Send_Email(u'jamly_liu')
    #email_send.send_mail()
    #porcess_wechart()  #微信处理
    #content="今天是"+today_data+","+subject
    #print(content)
    # mail_qq(subject,content)
    
#测试